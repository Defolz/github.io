$(document).ready(function(){const e="http://85.209.9.38:5000",o=$("#chat-list"),n=$("#messages");let i=null;function l(){o.find(".chat-item").each(function(){var t,a=$(this);a[0]===i?(n.empty(),a.addClass("chat-active"),t=a.attr("data-chat-id"),localStorage.setItem("chat_id",t)):a.removeClass("chat-active")})}function c(t){$.ajax({type:"GET",url:e+"/get_user_chats/"+t,success:function(t){var a=t.chats;const s=t.companion;console.log(a),console.log(s),0<a.length&&a.forEach(function(t,a){var e=s,t=$("<div>").addClass("chat-item").attr("data-chat-id",t).on("click",function(){i=this,l()}),n=$("<div>").addClass("chat-item-foto"),c=$("<div>").addClass("chat-item-info"),e=$("<p>").addClass("chat-item-nickname").text(e[a]),a=$("<p>").addClass("chat-item-last_message").text(localStorage.getItem("last_message"));c.append(e),c.append(a),t.append(n),t.append(c),o.append(t)}),0<a.length&&(i=o.find(".chat-item:first")[0],l())}})}$("#create-chat-btn").click(function(){$("#add-chat").removeClass("none")}),$("close-form").click(function(){$("#add-chat").addClass("none")}),$("#create-chat-from").submit(function(t){t.preventDefault();var a=localStorage.getItem("username"),t=$("#nickname-input").val();$.ajax({type:"POST",url:e+"/createChat",data:JSON.stringify({username:a,companion:t}),contentType:"application/json",success:function(t){alert(t.status),c(a)},error:function(t,a,e){alert("Ошибка: "+e)}})});localStorage.getItem("username");setInterval(c,100)});